#!/bin/bash
## Static vars
SCRIPTNAME="automount"

## Call to libgoran
. ./libgoran

## Code
vflag="true"
mounted="false"
{
    while true; do
        if ! ls /mnt/hdd/rpi > /dev/null 2>&1; then
            msgWarn "Folder /mnt/hdd/rpi does not exist!"
            if lsusb | grep SATA -q; then
                msgInfo "Found sda1 partition!"
                if mount /dev/sda1 /mnt/hdd > /dev/null 2>&1; then
                    msgOk "Partition sda1 mounted into /mnt/hdd!"
                    mounted="true"
                else
                    msgError "Cannot mount sda1 partition"
                fi
            else
                msgWarn "There is no SATA connected!"
            fi
        fi
        [[ $mounted == "false" ]] && msgInfo "Waiting 5 seconds..."
        sleep 5
    done
}
